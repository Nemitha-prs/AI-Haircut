<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HairCraft AI - Personalized Hairstyle Recommendations</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Background Animation -->
  <div class="background-container"></div>
  <div class="overlay"></div>

  <!-- Header -->
  <header class="header">
    <div class="container header-content">
      <div class="branding-block">
        <img src="logo.png" alt="HairCraft AI Logo" class="header-logo-img">
        <div class="brand-text">
          <h1 class="header-brand-title">HairCraft AI</h1>
          <p class="header-brand-subtitle">Smart AI Hairstyle Designer</p>
        </div>
      </div>
      <button id="logout-btn" type="button" class="logout-btn">Log Out</button>
    </div>
  </header>

  <main class="main-content">
    <div class="container">
      
      <!-- Hero Section -->
      <section class="hero-section">
        <h1 class="hero-title">Discover Your Perfect Look</h1>
        <p class="hero-subtitle">Upload your photo and let our AI analyze your face shape to recommend the best hairstyles for you.</p>
      </section>

      <!-- Upload Section -->
      <section class="upload-section">
        <div class="upload-card">
          <div class="card-header">
            <h2>Upload Photo</h2>
          </div>
          
          <form id="upload-form" class="upload-form">
            <div class="file-drop-area">
              <div class="drop-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
              </div>
              <p class="drop-text">Drag & drop your photo here or <span>browse</span></p>
              <p class="drop-hint">Supports JPG, PNG (Max 5MB)</p>
              <input type="file" id="photo" name="photo" accept="image/*" required class="file-input" />
            </div>

            <!-- Preview Area -->
            <div id="preview-wrap" class="preview-container" hidden>
              <div class="preview-frame">
                <img id="preview" alt="Selected photo preview" class="preview-image" />
                <div class="preview-overlay"></div>
              </div>
            </div>

            <!-- Analyze Button -->
            <button type="submit" id="analyze-btn" class="analyze-btn" disabled>
              <span id="btn-text">Analyze Face</span>
              <span id="btn-loader" class="button-loader" hidden></span>
            </button>
          </form>
        </div>

        <!-- Status Messages -->
        <div id="status-container" class="status-container" hidden>
          <div id="status-message" class="alert-message"></div>
        </div>

        <!-- Loading State -->
        <div id="loading-state" class="loading-state" hidden>
          <div class="spinner"></div>
          <h3>Analyzing Facial Geometry...</h3>
          <p>Identifying face shape, measurements, and features.</p>
        </div>
      </section>

      <!-- Results Section -->
      <section id="results" class="results-section" hidden>
        <div class="results-header">
          <h2>Analysis Results</h2>
        </div>

        <div class="results-grid">
          <!-- Left Column: User Image -->
          <div class="results-left">
            <div class="result-image-frame">
              <img id="results-preview" alt="Analysis preview" class="result-image" />
              <div class="scan-line"></div>
            </div>
          </div>

          <!-- Right Column: Attributes -->
          <div class="results-right">
            <!-- Face Shape Card -->
            <div class="attribute-card highlight-card">
              <div class="attr-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
              </div>
              <div class="attr-info">
                <div class="attr-label">Face Shape</div>
                <div class="attr-value-large" id="face-shape">Unknown</div>
              </div>
            </div>

            <!-- Demographics Grid -->
            <div class="demographics-grid">
              <div class="attribute-card">
                <div class="attr-info">
                  <div class="attr-label">Gender</div>
                  <div class="attr-value" id="gender">Unknown</div>
                </div>
              </div>
              
              <div id="age-row" class="attribute-card">
                <div class="attr-info">
                  <div class="attr-label">Est. Age</div>
                  <div class="attr-value" id="age">-</div>
                </div>
              </div>

              <div class="attribute-card">
                <div class="attr-info">
                  <div class="attr-label">Age Group</div>
                  <div class="attr-value" id="age-group">-</div>
                </div>
              </div>

              <div id="confidence-row" class="attribute-card">
                <div class="attr-info">
                  <div class="attr-label">Confidence</div>
                  <div class="attr-value" id="confidence">-</div>
                </div>
              </div>
            </div>

            <!-- Measurements -->
            <div id="measurements" class="measurements-block">
              <h3 class="measurements-title">Facial Measurements</h3>
              <div class="measurements-list">
                <div id="m-row-forehead" class="measurement-row">
                  <span>Forehead Width</span>
                  <span id="m-forehead" class="measurement-val">-</span>
                </div>
                <div id="m-row-cheek" class="measurement-row">
                  <span>Cheekbone Width</span>
                  <span id="m-cheek" class="measurement-val">-</span>
                </div>
                <div id="m-row-jaw" class="measurement-row">
                  <span>Jaw Width</span>
                  <span id="m-jaw" class="measurement-val">-</span>
                </div>
                <div id="m-row-length" class="measurement-row">
                  <span>Face Length</span>
                  <span id="m-length" class="measurement-val">-</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Suggestions Section -->
        <div class="suggestions-container">
          <div class="suggestions-header">
            <h3>Recommended Hairstyles</h3>
            <p>Curated based on your face shape and features</p>
          </div>
          
          <div id="suggestions" class="suggestions-grid">
            <!-- Suggestions injected by JS -->
          </div>
          
          <div id="no-suggestions" class="no-suggestions" hidden>
            <p>No specific hairstyles found for this face shape.</p>
          </div>
        </div>
      </section>

    </div>
  </main>

  <footer class="site-footer footer-premium">
    <div class="container footer-shell">
      <div class="footer-meta">
        <p class="footer-title">Â© 2025 HairCraft AI</p>
        <p class="footer-tagline">Created by Nemitha Prabashwara</p>
      </div>
      <div class="footer-links">
        <a class="footer-link" href="https://www.linkedin.com/in/nemitha-prabashwara-5aaa9b376" target="_blank" rel="noopener" aria-label="LinkedIn">
          <span class="footer-icon">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
          </span>
          <span>LinkedIn</span>
        </a>
        <a class="footer-link" href="https://www.instagram.com/nemitha_prs" target="_blank" rel="noopener" aria-label="Instagram">
          <span class="footer-icon">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"/></svg>
          </span>
          <span>Instagram</span>
        </a>
        <a class="footer-link" href="https://github.com/Nemitha-prs" target="_blank" rel="noopener" aria-label="GitHub">
          <span class="footer-icon">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-4.5 1.5-4.5-2.5-6-3m12 5v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 18 4.77 5.07 5.07 0 0 0 17.91 1S16.73.65 14 2.48a13.38 13.38 0 0 0-10 0C1.27.65.09 1 .09 1A5.07 5.07 0 0 0 0 4.77 5.44 5.44 0 0 0 1.5 8.52c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 7 18.13V22"/></svg>
          </span>
          <span>GitHub</span>
        </a>
        <span class="footer-divider"></span>
        <a class="footer-link" href="tel:+94779898273" aria-label="Phone">
          <span class="footer-icon">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.86 19.86 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6A19.86 19.86 0 0 1 2.08 4.18 2 2 0 0 1 4.06 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
          </span>
          <span>+94 77 98 98 273</span>
        </a>
        <a class="footer-link" href="mailto:nemithaprs@gmail.com" aria-label="Email">
          <span class="footer-icon">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
          </span>
          <span>nemithaprs@gmail.com</span>
        </a>
      </div>
    </div>
  </footer>

  <!-- Core Logic -->
  <script src="script.js"></script>
  <script>
      // Logout: clear token and redirect, preventing cached auth
      (function(){
        const btn = document.getElementById("logout-btn");
        if (btn) {
          btn.addEventListener("click", function(){
            try {
              localStorage.removeItem("authToken");
              localStorage.removeItem("jwt");
              localStorage.removeItem("userEmail");
              sessionStorage.clear();
            } catch (_) {}
            // Redirect to login page
            window.location.replace("login.html"); 
          });
        }
      })();
  </script>

  <!-- Background Animation Logic (Visual Only) -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const backgroundContainer = document.querySelector(".background-container");
      if (!backgroundContainer) return;

      const images = [
        "photos/0724aa014349187d6f3eb5804165a6cc.jpg",
        "photos/0d2a195ab157404f7a7af1bc34ad37cb.jpg",
        "photos/280f9d53291c55ad45ee867739683224.jpg",
        "photos/2861a5738dd327b3a3efb9b0d914c35e.jpg",
        "photos/2ca3897b0ab2e46c98e8bf069bee8cb6.jpg",
        "photos/583899899aa6da0664d9af52b105ed75.jpg",
        "photos/5d58d18711f67090ddffc9f4e83f0600.jpg",
        "photos/65b51e22d6adaeecfe5aef2cf05e85aa.jpg",
        "photos/85d92c4387ae6f211a488a8283b71bab.jpg",
        "photos/a4c02d2ecc9175b47ea91d64b79e74c5.jpg",
        "photos/c401968ab38c2e3842b9a101c20b71bb.jpg",
        "photos/c65841f8c3fe72838a5ba9779bb7a50a.jpg",
        "photos/fb911db59293048b2c49d2be8e39fc20.jpg",
        "photos/Fresh & Trendy_ New Haircuts for Men 2025 - 22 Ideas for Short, Curly, and Long Styles.jpeg",
        "photos/images.jpeg",
        "photos/pexels-photo-2379005.jpeg",
        "photos/pexels-pixabay-415829.jpg"
      ];

      const totalItems = 60; 
      const imagePool = [];
      
      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      let currentDeck = [];
      for (let i = 0; i < totalItems; i++) {
        if (currentDeck.length === 0) {
          currentDeck = [...images];
          shuffle(currentDeck);
          if (imagePool.length > 0 && currentDeck[0] === imagePool[imagePool.length - 1]) {
             [currentDeck[0], currentDeck[currentDeck.length - 1]] = [currentDeck[currentDeck.length - 1], currentDeck[0]];
          }
        }
        imagePool.push(currentDeck.pop());
      }

      imagePool.forEach((src) => {
        const gridItem = document.createElement("div");
        gridItem.className = "background-item";
        gridItem.style.backgroundImage = `url("${src}")`;
        gridItem.style.animation = `fadeIn 1.5s ease-out forwards, float ${20 + Math.random() * 10}s infinite ease-in-out`;
        gridItem.style.animationDelay = `${Math.random() * 3}s`;
        backgroundContainer.appendChild(gridItem);
      });
    });
  </script>
  <!-- UI Guard Script: Fixes button state and status message without touching script.js -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // 1. Ensure status message is empty on load
      const statusMsg = document.getElementById('status-message');
      if (statusMsg) statusMsg.textContent = '';

      // 2. Monitor loader visibility to toggle button text
      const btn = document.getElementById('analyze-btn');
      const loader = document.getElementById('btn-loader');
      
      if (btn && loader) {
        const observer = new MutationObserver(() => {
          if (!loader.hidden) {
            btn.classList.add('is-loading');
          } else {
            btn.classList.remove('is-loading');
          }
        });
        observer.observe(loader, { attributes: true, attributeFilter: ['hidden'] });
      }
    });
  </script>
</body>
</html>
